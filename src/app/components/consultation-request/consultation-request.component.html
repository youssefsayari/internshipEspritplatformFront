<div class="panel-header panel-header-sm"></div>
<div class="main-content">
  <div class="row justify-content-center">
    <div class="col-lg-10 col-md-12">
      <div class="card shadow-lg border-0 rounded-lg">
        <div class="card-header bg-gradient-primary text-white text-center py-3">
          <h4 class="mb-0"><i class="fas fa-comments"></i> Request a Consultation</h4>
        </div>

        <div class="card-body p-4">
          <form (ngSubmit)="onSubmit()" #consultationForm="ngForm" novalidate>

            <!-- Specialties -->
            <div class="form-group mb-3">
              <label for="specialty"><i class="fas fa-cogs"></i> Your Desired Specialties</label>
              <input
                type="text"
                id="specialty"
                name="specialty"
                class="form-control"
                [(ngModel)]="specialty"
                required
                minlength="3"
                maxlength="100"
                #specialtyInput="ngModel"
                placeholder="e.g., Java, Angular"
                [ngClass]="{ 'is-invalid': specialtyInput.invalid && (specialtyInput.dirty || specialtyInput.touched) }"
              />
              <div class="invalid-feedback" *ngIf="specialtyInput.errors?.['required']">Specialty is required.</div>
              <div class="invalid-feedback" *ngIf="specialtyInput.errors?.['minlength']">Specialty must be at least 3 characters long.</div>
              <div class="invalid-feedback" *ngIf="specialtyInput.errors?.['maxlength']">Specialty cannot exceed 100 characters.</div>
            </div>

            <!-- Start Time -->
            <div class="form-group mb-3">
              <label for="startTime"><i class="fas fa-clock"></i> Start Time</label>
              <input
                type="datetime-local"
                id="startTime"
                name="startTime"
                class="form-control"
                [(ngModel)]="startTime"
                required
                #startTimeInput="ngModel"
                (change)="updateEndTimeLimit()"
                [ngClass]="{ 'is-invalid': startTimeInput.invalid && (startTimeInput.dirty || startTimeInput.touched) }"
              />
              <div class="invalid-feedback" *ngIf="startTimeInput.errors?.['required']">Start time is required.</div>
            </div>

            <!-- End Time -->
            <div class="form-group mb-4">
              <label for="endTime"><i class="fas fa-hourglass-end"></i> End Time (Max 40 mins after start)</label>
              <input
                type="datetime-local"
                id="endTime"
                name="endTime"
                class="form-control"
                [(ngModel)]="endTime"
                required
                [min]="startTime"
                [max]="maxEndTime"
                #endTimeInput="ngModel"
                [ngClass]="{ 'is-invalid': endTimeInput.invalid && (endTimeInput.dirty || endTimeInput.touched) }"
              />
              <div class="invalid-feedback" *ngIf="endTimeInput.errors?.['required']">End time is required.</div>
              <div class="invalid-feedback" *ngIf="endTime && startTime && endTime > maxEndTime">End time cannot be more than 40 minutes from start.</div>
            </div>

            <!-- Submit Button -->
            <div class="text-center mt-4">
              <button type="submit" class="btn btn-success btn-lg px-4 rounded-pill" [disabled]="consultationForm.invalid">
                <i class="fas fa-paper-plane"></i> Submit Consultation Request
              </button>
            </div>

            <!-- Optional Back Link -->
            <div class="text-center mt-3">
              <a routerLink="/dashboard" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Dashboard
              </a>
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Toast Notification Container -->
<div aria-live="polite" aria-atomic="true" class="position-fixed top-0 end-0 p-3" style="z-index: 1050;">
  <div *ngFor="let toast of toasts" class="toast align-items-center text-white bg-success border-0 show" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">
        {{ toast.message }}
      </div>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
</div>
